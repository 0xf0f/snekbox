[[source]]
url = "https://pypi.org/simple"
verify_ssl = true
name = "pypi"

[packages]
falcon = "*"
gunicorn = "*"
jsonschema = "*"

[dev-packages]
pytest = "*"
pytest-cov = "*"
pytest-dependency = "*"
pre-commit = "*"
flake8 = "*"
flake8-docstrings = "*"
flake8-bugbear = "*"
flake8-import-order = "*"
flake8-tidy-imports = "*"
flake8-todo = "*"
flake8-string-format = "*"
flake8-formatter-junit-xml = "*"
flake8-quotes = "*"

[requires]
python_version = "3.7"

[scripts]
lint = "flake8"
precommit = "pre-commit install"
test = "pytest tests --cov . --cov-report term-missing -v"
report = "pytest tests --cov . --cov-report=html"
snekbox = """
    gunicorn \
        -w 2 \
        -b 0.0.0.0:8060 \
        --logger-class snekbox.GunicornLogger \
        --access-logformat '%(m)s %(U)s%(q)s %(s)s %(b)s %(L)ss' \
        --access-logfile - \
        snekbox.api.app
"""
build-venv-dev = """
    docker build \
        -t pythondiscord/snekbox-venv:dev \
        -f docker/venv.Dockerfile
        --build-arg DEV=1 \
        .
"""
devsh = """
    /usr/bin/env sh -c '
        docker run \
            -it \
            --rm \
            --privileged \
            --network host \
            -h pdsnk-dev \
            -e PIPENV_PIPFILE="/snekbox/Pipfile" \
            -e ENV="/snekbox-local/docker/.profile" \
            -v "$(pwd)":/snekbox-local \
            -w "/snekbox-local" \
            --entrypoint /bin/ash \
            pythondiscord/snekbox-venv:dev
    '
"""
buildbox = "docker build -t pythondiscord/snekbox:latest -f docker/Dockerfile ."
pushbox = "docker push pythondiscord/snekbox:latest"
buildboxbase = "docker build -t pythondiscord/snekbox-base:latest -f docker/base.Dockerfile ."
pushboxbase = "docker push pythondiscord/snekbox-base:latest"
